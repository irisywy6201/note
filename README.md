
Hi today we are going to introduce the architecture of common auth, and this page is our design, the two main point is envoyfiler, and the common auth service, 
Envoyfilter is an istio resource that you can use to listen for requests, and it's very similar to Nginx, where you can write Lua's code in envoyfilter and have every request that comes in do the logic.
When a user request comes in, it can determine whether the user has logged in or not. If not, envoyfilter can help to redirects the page to the tSSO login page, and when USER logs in, it can send another request to common auth service to help complete the OIDC flow, and then get the ID Token, the id token is used in tsso to authenticate the user, just like the previous a 4cookie
Next, take an end-to-end process for example, if there is a user who has never logged in to TSSO and want to open A web page, envoyfilter will check if ID token exist in the requestâ€™s cookie, after envoyfilter finds out that there is no cookie named ID token in the request, the page will redirect to tsso login page. After user successfully login, envoyfilter will help to send request to common AUTH service to do OIDC Flow to help user get id token, and put the id token in the user browser cookie through envoyfiler, so finally user can use our web page normally because of the id token,
